自用训练Lora模型的脚本说明，入口脚本为：lora_train_command_line.py,使用方法：直接打开该脚本，按照注释配置参数，直接运行即可
原始脚本：https://github.com/kohya-ss/sd-scripts
使用说明：

1. 收集数据集，数据为多张图片，图片包含需要训练的元素：人物、风格、物体等等，图片分辨率不需要统一，但尺寸应当控制在合理范围内，脚本参数包含最大最小分辨率设置，综合实际硬件的参数设置确定图片。

2. 数据及预处理，包括去噪(噪点、水印、无关内容等)、调整分辨率(分辨率应当同时满足硬件能力要求和脚本设置，通过下采样和超分辨率等方法调整)，图片中不相关元素越少越容易训练，必要时可以考虑扣图去除背景，使用纯色背景。

3. 图片打TAG，可以使用webui中训练下的图片预处理功能，但推荐使用tag插件，注意：手动删去TAG中训练元素相关TAG有利于模型学习到元素特征，但会损害泛化性，不如训练红色头发角色，删去红色头发的TAG，将无法产生粉色或绿色头发的变体，但模型的训练会因为学习更少的TAG而变得容易。这里推荐不要手动删除TAG，相反要经可能详细描述图片的所有元素，使用这些TAG仍然可以获得很好的角色还原，同时保留优秀的泛化性。

4. [可选] 生成正则化照片，数量与训练图片对应，不需要打TAG，文件存储结构与训练数据集相同，数量不应当过少，使得训练图像的迭代次数 x 训练图像的数量 ≥ 正则化图像的迭代次数 x 正则化图像的数量。一个epoch的数据数量为“训练图像的重复次数x训练图像的数量”。如果正则化图像的数量大于此，则不会使用剩余的正则化图像。可以显著改善过拟合，lora训练非常容易过拟合(epoch 设置为1仍然会产生过拟合，同时元素特征学习的也不好)，正则化图片与训练样本向对应，他们具有相同的TAG，但由AI(生成模型与训练模型相同)生成，这些图片和训练真实样本的对照可以有效克服过拟合，从而学习到更好的特征。使用正则化功能需要在脚本参数中设置正则化图片路径。

5. 设置图片结构，单一元素图片放置到一个文件夹中，文件夹命名格式为 [数字]_[概念]的格式，数字为正整数，表示该文件夹内的图片在训练中的重复次数，概念表示模型将元素特征映射到的TAG，因此不能与已有的TAG重复。该文件夹可以有多个，放置在训练目录下。

6. 根据需要设置脚本参数，参数解释已经写到脚本中，除参数可依照说明更改外，不要更改其他内容。直接运行该脚本即可开始训练，不需要任何命令行参数。

部分经验：
```
较多的正则化图片可能导致拟合困难
```
